Задача
=
Даны 2 окружности. Известны их **радиусы** и **координаты их центров**.

Найти
=
Площадь пересечения окружностей

Решение
=

Решим более простую задачу. Найдем точки пересечения окружностей [`Источник`](http://algolist.manual.ru/maths/geom/intersect/circlecircle2d.php).

Есть две окружности с центрами в точках A и B. Их координаты известны. Также известны радиусы окружностей. Нужно найти координаты точек C и D.

Допустим окружности пересекаются.
<p align="center">
  <img src="https://github.com/viCodexm/competitive-programming/blob/main/Вычислительная%20геометрия/Пересечение%20двух%20окружностей/Картинки/Картинкадвеокр.png" width="1000"/>
</p>

1. Найдем координаты точки H (центр хорды CD, соединяющией точки пересечения окружностей).
Рассмотрим треугольники AСH и BСH. Обозначим расстояние между центрами окружностей за d, сторону AH за a, BH за b, CH за h. 

Расстояние между центрами окружностей рассчитывается по теореме Пифагора:
$${\Huge d = \sqrt{ {({x}_B-{x}_A)}^{2} - {({y}_B-{y}_A)}^{2}}}$$

Найдем длину стороны a, решив систему уравнений:

$${\Huge \\begin{cases} 
    {r}^{2}_a - {a}^{2} = {h}^{2}\\       
    {r}^{2}_b - {b}^{2} = {h}^{2}\\  
    d = a + b
  \end{cases}}$$

,где $\Huge r_a$ - радиус окружности A, $\Huge r_b$ - радиус окружности B.

Подставим вместо $\Huge {h}^{2}$ в первом уравнении второе уравнение и выразим значение b из третьего уравнения: 

$${\Huge \\begin{cases} 
    {r}^{2}_a - {a}^{2} = {r}^{2}_b - {b}^{2}\\       
     b = d - a  
  \end{cases}}$$

Выразим а. Упростив систему уравнений, получим:

$${\Huge a=\frac{{r}^{2}_a-{r}^{2}_b+{d}^{2}}{2d} }$$

Теперь рассчитаем координаты точки H.

$${\Huge {x}_H={x}_A+\frac{a*({x}_B-{x}_A)}{d} }$$

$${\Huge {y}_H={y}_A+\frac{a*({y}_B-{y}_A)}{d} }$$


Вычитаем абсциссу(x) центра окружности A из абсциссы центра окружности B и делим на расстояние между центрами окружностей - d. Получился косинус угла между отрезками AH и горизонтальной линией, начинающейся в абсциссе точки A и заканчивающийся в абсциссе точки B. Умножаем получившийся косинус на длину отрезка а и получаем длину проекции отрезка AH на горизонтальную линию от точки а до абсциссы точки B. Складываем получившееся число с абсциссой точки A и получаем абсциссу точки H.

Для ординаты(y) аналогично.

2. Найдем координаты точек С и D по следующим формулам:

$${\Huge h = \sqrt{ {r}^{2}_a - {a}^{2}}}$$

$${\Huge {x}_C={x}_H-\frac{h*({y}_B-{y}_A)}{d} }$$

$${\Huge {y}_C={y}_H+\frac{h*({x}_B-{x}_A)}{d} }$$


$${\Huge {x}_D={x}_H+\frac{h*({y}_B-{y}_A)}{d} }$$

$${\Huge {y}_D={y}_H-\frac{h*({x}_B-{x}_A)}{d} }$$

Точки C и D диаметрально противоположны, поэтому для второй точки мы прибавляем длину проекции по оси абсцисс, а по оси ординат вычитаем.

[`Подробная визуализация`](https://www.desmos.com/calculator/e3qbfnzhje)
=
А теперь пересечение окружностей
=

Доказательство формулы здесь - [`Источник`](https://diego.assencio.com/?index=8d6ca3d82151bad815f78addf9b5c1c6)

Формула площади пересечения двух окружностей:

$${\Huge S = ({r}^{2}_a * \arccos{\frac{a}{r_a}} - a * \sqrt{ {r}^{2}_a - {a}^{2}}) + 
({r}^{2}_b * \arccos{\frac{b}{r_b}} - b * \sqrt{ {r}^{2}_b - {b}^{2}})}$$

или 

$${\Huge S = ({r}^{2}_a * \arccos{\frac{a}{r_a}} - a * h) + 
({r}^{2}_b * \arccos{\frac{b}{r_b}} - b * h)}$$
